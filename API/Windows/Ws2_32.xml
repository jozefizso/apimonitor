<!--
    API Monitor Definitions
    (c) 2010-2011, Rohitab Batra <rohitab@rohitab.com>
    http://www.rohitab.com/apimonitor/
    
    TODO: Check return values since most API's fail when return is -1. We are currently checking for 0
-->
<ApiMonitor>
    <Include Filename="Headers\windows.h.xml" />
    <Include Filename="Headers\sockets.h.xml" />
    <Module Name="Ws2_32.dll" CallingConvention="STDCALL" ErrorFunc="WSAGetLastError" OnlineHelp="MSDN">
        <!-- Variables -->
        
        <!-- [LookupServiceFlags] -->
        <Variable Name="[LookupServiceFlags]" Type="Alias" Base="DWORD">
            <Display Name="DWORD" />
            <Flag>
                <Set Name="LUP_DEEP"                        Value="0x0001" />
                <Set Name="LUP_CONTAINERS"                  Value="0x0002" />
                <Set Name="LUP_NOCONTAINERS"                Value="0x0004" />
                <Set Name="LUP_NEAREST"                     Value="0x0008" />
                <Set Name="LUP_RETURN_NAME"                 Value="0x0010" />
                <Set Name="LUP_RETURN_TYPE"                 Value="0x0020" />
                <Set Name="LUP_RETURN_VERSION"              Value="0x0040" />
                <Set Name="LUP_RETURN_COMMENT"              Value="0x0080" />
                <Set Name="LUP_RETURN_ADDR"                 Value="0x0100" />
                <Set Name="LUP_RETURN_BLOB"                 Value="0x0200" />
                <Set Name="LUP_RETURN_ALIASES"              Value="0x0400" />
                <Set Name="LUP_RETURN_QUERY_STRING"         Value="0x0800" />
                <Set Name="LUP_RETURN_ALL"                  Value="0x0FF0" />
                <Set Name="LUP_RES_SERVICE"                 Value="0x8000" />
                <Set Name="LUP_FLUSHCACHE"                  Value="0x1000" />
                <Set Name="LUP_FLUSHPREVIOUS"               Value="0x2000" />
                <Set Name="LUP_NON_AUTHORITATIVE"           Value="0x4000" />
                <Set Name="LUP_SECURE"                      Value="0x8000" />
                <Set Name="LUP_RETURN_PREFERRED_NAMES"      Value="0x10000" />
                <Set Name="LUP_ADDRCONFIG"                  Value="0x00100000" />
                <Set Name="LUP_DUAL_ADDR"                   Value="0x00200000" />
            </Flag>
        </Variable>
        
        <!-- [WsaFlags]-->
        <Variable Name="[WsaFlags]" Type="Alias" Base="DWORD">
            <Display Name="DWORD" />
            <Flag>
                <Set Name="WSA_FLAG_OVERLAPPED"             Value="0x01" />
                <Set Name="WSA_FLAG_MULTIPOINT_C_ROOT"      Value="0x02" />
                <Set Name="WSA_FLAG_MULTIPOINT_C_LEAF"      Value="0x04" />
                <Set Name="WSA_FLAG_MULTIPOINT_D_ROOT"      Value="0x08" />
                <Set Name="WSA_FLAG_MULTIPOINT_D_LEAF"      Value="0x10" />
                <Set Name="WSA_FLAG_ACCESS_SYSTEM_SECURITY" Value="0x40" />
            </Flag>
        </Variable>
        
        <!-- [FDEvents] -->
        <Variable Name="[FDEvents]" Type="Alias" Base="ULONG">
            <Display Name="long" />
            <Flag>
                <Set Name="FD_READ"                     Value="0x00000001" />
                <Set Name="FD_WRITE"                    Value="0x00000002" />
                <Set Name="FD_OOB"                      Value="0x00000004" />
                <Set Name="FD_ACCEPT"                   Value="0x00000008" />
                <Set Name="FD_CONNECT"                  Value="0x00000010" />
                <Set Name="FD_CLOSE"                    Value="0x00000020" />
                <Set Name="FD_QOS"                      Value="0x00000040" />
                <Set Name="FD_GROUP_QOS"                Value="0x00000080" />
                <Set Name="FD_ROUTING_INTERFACE_CHANGE" Value="0x00000100" />
                <Set Name="FD_ADDRESS_LIST_CHANGE"      Value="0x00000200" />
            </Flag>
        </Variable>
        
        <!-- Windows Sockets 2 -->
        <Category Name="Networking/Network Protocols/Windows Sockets 2" />
        <Api Name="accept" Ordinal="1">
            <Param Type="SOCKET" Name="s" />
            <Param Type="struct sockaddr*" Name="addr" />
            <Param Type="int*" Name="addrlen" />
            <Return Type="SOCKET" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="bind" Ordinal="2">
            <Param Type="SOCKET" Name="s" />
            <Param Type="const struct sockaddr*" Name="name" Length="namelen" />
            <Param Type="int" Name="namelen" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="closesocket" Ordinal="3">
            <Param Type="SOCKET" Name="s" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="connect" Ordinal="4">
            <Param Type="SOCKET" Name="s" />
            <Param Type="const struct sockaddr*" Name="name" Length="namelen" />
            <Param Type="int" Name="namelen" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="freeaddrinfo" Ordinal="162">
            <Param Type="struct addrinfo*" Name="ai" />
            <Return Type="void" />
        </Api>
        <Api Name="getaddrinfo" Ordinal="163" ErrorIsReturnValue="True">
            <Param Type="const char*" Name="nodename" />
            <Param Type="const char*" Name="servname" />
            <Param Type="const struct addrinfo*" Name="hints" />
            <Param Type="struct addrinfo**" Name="res" />
            <Return Type="int" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="FreeAddrInfoEx" BothCharset="True" OrdinalA="25" OrdinalW="26" SuffixA="">
            <Param Type="PADDRINFOEX" Name="pAddrInfo" />
            <Return Type="void" />
        </Api>
        <Api Name="GetAddrInfoEx" BothCharset="True" OrdinalA="28" OrdinalW="29" ErrorIsReturnValue="True">
            <Param Type="PCTSTR" Name="pName" />
            <Param Type="PCTSTR" Name="pServiceName" />
            <Param Type="[NameSpaceFlags]" Name="dwNameSpace" />
            <Param Type="LPGUID" Name="lpNspId" />
            <Param Type="const ADDRINFOEX*" Name="pHints" />
            <Param Type="PADDRINFOEX*" Name="ppResult" />
            <Param Type="struct timeval*" Name="timeout" />
            <Param Type="LPOVERLAPPED" Name="lpOverlapped" />
            <Param Type="LPLOOKUPSERVICE_COMPLETION_ROUTINE" Name="lpCompletionRoutine" />
            <Param Type="LPHANDLE" Name="lpNameHandle" />
            <Return Type="int" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="FreeAddrInfoW" Ordinal="27">
            <Param Type="PADDRINFOW" Name="pAddrInfo" />
            <Return Type="void" />
        </Api>
        <Api Name="GetAddrInfoW" Ordinal="30" ErrorIsReturnValue="True">
            <Param Type="PCWSTR" Name="pNodeName" />
            <Param Type="PCWSTR" Name="pServiceName" />
            <Param Type="const ADDRINFOW*" Name="pHints" />
            <Param Type="PADDRINFOW*" Name="ppResult" />
            <Return Type="int" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="gethostbyaddr" Ordinal="51">
            <Param Type="const char*" Name="addr" />
            <Param Type="int" Name="len" />
            <Param Type="[AddressFamily]" Name="type" />
            <Return Type="struct hostent*" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="gethostbyname" Ordinal="52">
            <Param Type="const char*" Name="name" />
            <Return Type="struct hostent*" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="gethostname" Ordinal="57">
            <Param Type="char*" Name="name" OutputOnly="True" />
            <Param Type="int" Name="namelen" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="getnameinfo" Ordinal="164">
            <Param Type="const struct sockaddr*" Name="sa" Length="salen" />
            <Param Type="socklen_t" Name="salen" />
            <Param Type="char*" Name="host" OutputOnly="True" />
            <Param Type="DWORD" Name="hostlen" />
            <Param Type="char*" Name="serv" OutputOnly="True" />
            <Param Type="DWORD" Name="servlen" />
            <Param Type="[NI_Flags]" Name="flags" />
            <Return Type="int" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="GetNameInfoW" Ordinal="31">
            <Param Type="const SOCKADDR*" Name="pSockaddr" />
            <Param Type="socklen_t" Name="SockaddrLength" />
            <Param Type="PWCHAR" Name="pNodeBuffer" />
            <Param Type="DWORD" Name="NodeBufferSize" />
            <Param Type="PWCHAR" Name="pServiceBuffer" />
            <Param Type="DWORD" Name="ServiceBufferSize" />
            <Param Type="[NI_Flags]" Display="INT" Name="Flags" />
            <Return Type="int" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="getpeername" Ordinal="5">
            <Param Type="SOCKET" Name="s" />
            <Param Type="struct sockaddr*" Name="name" />
            <Param Type="int*" Name="namelen" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="getprotobyname" Ordinal="53">
            <Param Type="const char*" Name="name" />
            <Return Type="struct PROTOENT*" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="getprotobynumber" Ordinal="54">
            <Param Type="int" Name="number" />
            <Return Type="struct PROTOENT*" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="getservbyname" Ordinal="55">
            <Param Type="const char*" Name="name" />
            <Param Type="const char*" Name="proto" />
            <Return Type="struct servent*" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="getservbyport" Ordinal="56">
            <Param Type="int" Name="port" />
            <Param Type="const char*" Name="proto" />
            <Return Type="struct servent*" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="getsockname" Ordinal="6">
            <Param Type="SOCKET" Name="s" />
            <Param Type="struct sockaddr*" Name="name" Length="namelen" />
            <Param Type="int*" Name="namelen" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="getsockopt" Ordinal="7">
            <Param Type="SOCKET" Name="s" />
            <Param Type="[SocketLevel]" Name="level" />
            <Param Type="[SocketOption]" Name="optname" />
            <Param Type="LPVOID" Display="char*" Name="optval" PostLength="optlen" />
            <Param Type="int*" Name="optlen" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="htonl" Ordinal="8">
            <Param Type="u_long" Name="hostlong" />
            <Return Type="u_long" />
        </Api>
        <Api Name="htons" Ordinal="9">
            <Param Type="u_short" Name="hostshort" />
            <Return Type="u_short" />
        </Api>
        <Api Name="inet_addr" Ordinal="11" ErrorFunc="">
            <Param Type="const char*" Name="cp" />
            <Return Type="unsigned long" />
            <Success Return="NotEqual" Value="0xffffffff" />
        </Api>
        <Api Name="inet_ntoa" Ordinal="12">
            <Param Type="struct in_addr" Name="in" />
            <Return Type="char*" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="InetNtopW" Ordinal="32">
            <Param Type="INT" Name="Family" />
            <Param Type="PVOID" Name="pAddr" />
            <Param Type="PWSTR" Name="pStringBuf" />
            <Param Type="size_t" Name="StringBufSize" />
            <Return Type="PCWSTR" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="inet_ntop" Ordinal="165">
            <Param Type="INT" Name="Family" />
            <Param Type="PVOID" Name="pAddr" />
            <Param Type="PSTR" Name="pStringBuf" />
            <Param Type="size_t" Name="StringBufSize" />
            <Return Type="PCSTR" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="inet_pton" Ordinal="166">
            <Param Type="INT" Name="Family" />
            <Param Type="PCSTR" Name="pszAddrString" />
            <Param Type="PVOID" Name="pAddrBuf" />
            <Return Type="PCSTR" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="InetPtonW" Ordinal="33">
            <Param Type="INT" Name="Family" />
            <Param Type="PCWSTR" Name="pszAddrString" />
            <Param Type="PVOID" Name="pAddrBuf" />
            <Return Type="PCWSTR" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="ioctlsocket" Ordinal="10">
            <Param Type="SOCKET" Name="s" />
            <Param Type="long" Name="cmd" />
            <Param Type="u_long*" Name="argp" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="listen" Ordinal="13">
            <Param Type="SOCKET" Name="s" />
            <Param Type="int" Name="backlog" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="ntohl" Ordinal="14">
            <Param Type="u_long" Name="netlong" />
            <Return Type="u_long" />
        </Api>
        <Api Name="ntohs" Ordinal="15">
            <Param Type="u_short" Name="netshort" />
            <Return Type="u_short" />
        </Api>
        <Api Name="recv" Ordinal="16">
            <Param Type="SOCKET" Name="s" />
            <Param Type="LPVOID" Display="char*" Name="buf" Length="[Retval]" />
            <Param Type="int" Name="len" />
            <Param Type="[SendRecvFlags]" Display="int" Name="flags" />
            <Return Type="[SocketCode-int]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="recvfrom" Ordinal="17">
            <Param Type="SOCKET" Name="s" />
            <Param Type="LPVOID" Display="char*" Name="buf" Length="[Retval]" />
            <Param Type="int" Name="len" />
            <Param Type="int" Name="flags" />
            <Param Type="struct sockaddr*" Name="from" />
            <Param Type="int*" Name="fromlen" />
            <Return Type="[SocketCode-int]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="select" Ordinal="18">
            <Param Type="int" Name="nfds" />
            <Param Type="fd_set*" Name="readfds" />
            <Param Type="fd_set*" Name="writefds" />
            <Param Type="fd_set*" Name="exceptfds" />
            <Param Type="const struct timeval*" Name="timeout" />
            <Return Type="[SocketCode-int]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="send" Ordinal="19">
            <Param Type="SOCKET" Name="s" />
            <Param Type="LPVOID" Display="const char*" Name="buf" Length="len" />
            <Param Type="int" Name="len" />
            <Param Type="[SendRecvFlags]" Display="int" Name="flags" />
            <Return Type="[SocketCode-int]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="sendto" Ordinal="20">
            <Param Type="SOCKET" Name="s" />
            <Param Type="LPVOID" Display="const char*" Name="buf" Length="len" />
            <Param Type="int" Name="len" />
            <Param Type="[SendRecvFlags]" Display="int" Name="flags" />
            <Param Type="const struct sockaddr*" Name="to" />
            <Param Type="int" Name="tolen" />
            <Return Type="[SocketCode-int]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="SetAddrInfoEx" BothCharset="True" OrdinalA="34" OrdinalW="35" ErrorIsReturnValue="True">
            <Param Type="PCTSTR" Name="pName" />
            <Param Type="PCTSTR" Name="pServiceName" />
            <Param Type="SOCKET_ADDRESS*" Name="pAddresses" />
            <Param Type="DWORD" Name="dwAddressCount" />
            <Param Type="LPBLOB" Name="lpBlob" />
            <Param Type="DWORD" Name="dwFlags" />
            <Param Type="[NameSpaceFlags]" Name="dwNameSpace" />
            <Param Type="LPGUID" Name="lpNspId" />
            <Param Type="struct timeval*" Name="timeout" />
            <Param Type="LPOVERLAPPED" Name="lpOverlapped" />
            <Param Type="LPLOOKUPSERVICE_COMPLETION_ROUTINE" Name="lpCompletionRoutine" />
            <Param Type="LPHANDLE" Name="lpNameHandle" />
            <Return Type="int" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="setsockopt" Ordinal="21">
            <Param Type="SOCKET" Name="s" />
            <Param Type="[SocketLevel]" Name="level" />
            <Param Type="[SocketOption]" Name="optname" />
            <Param Type="LPVOID" Display="const char*" Name="optval" Length="optlen" />
            <Param Type="int" Name="optlen" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="shutdown" Ordinal="22">
            <Param Type="SOCKET" Name="s" />
            <Param Type="[SocketShutdownFlags]" Name="how" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="socket" Ordinal="23">
            <Param Type="[AddressFamily]" Name="af" />
            <Param Type="[SocketType]" Name="type" />
            <Param Type="[SocketProtocol]" Name="protocol" />
            <Return Type="SOCKET" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSAAccept" Ordinal="37">
            <Param Type="SOCKET" Name="s" />
            <Param Type="struct sockaddr*" Name="addr" />
            <Param Type="LPINT" Name="addrlen" />
            <Param Type="LPCONDITIONPROC" Name="lpfnCondition" />
            <Param Type="DWORD" Name="dwCallbackData" />
            <Return Type="SOCKET" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSAAddressToString" BothCharset="True" OrdinalA="38" OrdinalW="39">
            <Param Type="LPSOCKADDR" Name="lpsaAddress" />
            <Param Type="DWORD" Name="dwAddressLength" />
            <Param Type="LPWSAPROTOCOL_INFO" Name="lpProtocolInfo" />
            <Param Type="LPTSTR" Name="lpszAddressString" />
            <Param Type="LPDWORD" Name="lpdwAddressStringLength" />
            <Return Type="[SocketCode-INT]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSAAsyncGetHostByAddr" Ordinal="102">
            <Param Type="HWND" Name="hWnd" />
            <Param Type="unsigned int" Name="wMsg" />
            <Param Type="const char*" Name="addr" />
            <Param Type="int" Name="len" />
            <Param Type="int" Name="type" />
            <Param Type="char*" Name="buf" />
            <Param Type="int" Name="buflen" />
            <Return Type="HANDLE" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="WSAAsyncGetHostByName" Ordinal="103">
            <Param Type="HWND" Name="hWnd" />
            <Param Type="unsigned int" Name="wMsg" />
            <Param Type="const char*" Name="name" />
            <Param Type="char*" Name="buf" />
            <Param Type="int" Name="buflen" />
            <Return Type="HANDLE" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="WSAAsyncGetProtoByName" Ordinal="105">
            <Param Type="HWND" Name="hWnd" />
            <Param Type="unsigned int" Name="wMsg" />
            <Param Type="const char*" Name="name" />
            <Param Type="char*" Name="buf" />
            <Param Type="int" Name="buflen" />
            <Return Type="HANDLE" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="WSAAsyncGetProtoByNumber" Ordinal="104">
            <Param Type="HWND" Name="hWnd" />
            <Param Type="unsigned int" Name="wMsg" />
            <Param Type="int" Name="number" />
            <Param Type="char*" Name="buf" />
            <Param Type="int" Name="buflen" />
            <Return Type="HANDLE" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="WSAAsyncGetServByName" Ordinal="107">
            <Param Type="HWND" Name="hWnd" />
            <Param Type="unsigned int" Name="wMsg" />
            <Param Type="const char*" Name="name" />
            <Param Type="const char*" Name="proto" />
            <Param Type="char*" Name="buf" />
            <Param Type="int" Name="buflen" />
            <Return Type="HANDLE" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="WSAAsyncGetServByPort" Ordinal="106">
            <Param Type="HWND" Name="hWnd" />
            <Param Type="unsigned int" Name="wMsg" />
            <Param Type="int" Name="port" />
            <Param Type="const char*" Name="proto" />
            <Param Type="char*" Name="buf" />
            <Param Type="int" Name="buflen" />
            <Return Type="HANDLE" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="WSAAsyncSelect" Ordinal="101">
            <Param Type="SOCKET" Name="s" />
            <Param Type="HWND" Name="hWnd" />
            <Param Type="unsigned int" Name="wMsg" />
            <Param Type="long" Name="lEvent" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSACancelAsyncRequest" Ordinal="108">
            <Param Type="HANDLE" Name="hAsyncTaskHandle" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSACleanup" Ordinal="116">
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSACloseEvent" Ordinal="41">
            <Param Type="WSAEVENT" Name="hEvent" />
            <Return Type="BOOL" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="WSAConnect" Ordinal="42">
            <Param Type="SOCKET" Name="s" />
            <Param Type="const struct sockaddr*" Name="name" />
            <Param Type="int" Name="namelen" />
            <Param Type="LPWSABUF" Name="lpCallerData" />
            <Param Type="LPWSABUF" Name="lpCalleeData" />
            <Param Type="LPQOS" Name="lpSQOS" />
            <Param Type="LPQOS" Name="lpGQOS" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSAConnectByList" Ordinal="43">
            <Param Type="SOCKET" Name="s" />
            <Param Type="PSOCKET_ADDRESS_LIST" Name="SocketAddressList" />
            <Param Type="LPDWORD" Name="LocalAddressLength" />
            <Param Type="LPSOCKADDR" Name="LocalAddress" />
            <Param Type="LPDWORD" Name="RemoteAddressLength" />
            <Param Type="LPSOCKADDR" Name="RemoteAddress" />
            <Param Type="const struct timeval*" Name="timeout" />
            <Param Type="LPWSAOVERLAPPED" Name="Reserved" />
            <Return Type="BOOL" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="WSAConnectByName" BothCharset="True" OrdinalA="44" OrdinalW="45">
            <Param Type="SOCKET" Name="s" />
            <Param Type="LPSTR" Name="nodename" />
            <Param Type="LPSTR" Name="servicename" />
            <Param Type="LPDWORD" Name="LocalAddressLength" />
            <Param Type="LPSOCKADDR" Name="LocalAddress" />
            <Param Type="LPDWORD" Name="RemoteAddressLength" />
            <Param Type="LPSOCKADDR" Name="RemoteAddress" />
            <Param Type="const struct timeval*" Name="timeout" />
            <Param Type="LPWSAOVERLAPPED" Name="Reserved" />
            <Return Type="BOOL" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="WSACreateEvent" Ordinal="46">
            <Return Type="WSAEVENT" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="WSADuplicateSocket" BothCharset="True" OrdinalA="47" OrdinalW="48">
            <Param Type="SOCKET" Name="s" />
            <Param Type="DWORD" Name="dwProcessId" />
            <Param Type="LPWSAPROTOCOL_INFO" Name="lpProtocolInfo" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSAEnumNameSpaceProviders" BothCharset="True" OrdinalA="49" OrdinalW="59">
            <Param Type="LPDWORD" Name="lpdwBufferLength" />
            <Param Type="LPWSANAMESPACE_INFO" Name="lpnspBuffer" />
            <Return Type="[SocketCode-INT]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSAEnumNameSpaceProvidersEx" BothCharset="True" OrdinalA="50" OrdinalW="58">
            <Param Type="LPDWORD" Name="lpdwBufferLength" />
            <Param Type="LPWSANAMESPACE_INFOEX" Name="lpnspBuffer" />
            <Return Type="[SocketCode-INT]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSAEnumNetworkEvents" Ordinal="60">
            <Param Type="SOCKET" Name="s" />
            <Param Type="WSAEVENT" Name="hEventObject" />
            <Param Type="LPWSANETWORKEVENTS" Name="lpNetworkEvents" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSAEnumProtocols" BothCharset="True" OrdinalA="61" OrdinalW="62">
            <Param Type="LPINT" Name="lpiProtocols" />
            <Param Type="LPWSAPROTOCOL_INFO" Name="lpProtocolBuffer" PostCount="[Retval]" />
            <Param Type="LPDWORD" Name="lpdwBufferLength" />
            <Return Type="[SocketCode-int]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSAEventSelect" Ordinal="63">
            <Param Type="SOCKET" Name="s" />
            <Param Type="WSAEVENT" Name="hEventObject" />
            <Param Type="[FDEvents]" Name="lNetworkEvents" />
            <Return Type="[SocketCode-int]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSAGetLastError" Ordinal="111">
            <Return Type="int" />
        </Api>
        <Api Name="WSAGetOverlappedResult" Ordinal="64">
            <Param Type="SOCKET" Name="s" />
            <Param Type="LPWSAOVERLAPPED" Name="lpOverlapped" />
            <Param Type="LPDWORD" Name="lpcbTransfer" />
            <Param Type="BOOL" Name="fWait" />
            <Param Type="LPDWORD" Name="lpdwFlags" />
            <Return Type="BOOL" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="WSAGetServiceClassInfo" BothCharset="True" OrdinalA="66" OrdinalW="67">
            <Param Type="LPGUID" Name="lpProviderId" />
            <Param Type="LPGUID" Name="lpServiceClassId" />
            <Param Type="LPDWORD" Name="lpdwBufferLength" />
            <Param Type="LPWSASERVICECLASSINFO" Name="lpServiceClassInfo" />
            <Return Type="[SocketCode-INT]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSAGetServiceClassNameByClassId" BothCharset="True" OrdinalA="68" OrdinalW="69">
            <Param Type="LPGUID" Name="lpServiceClassId" />
            <Param Type="LPTSTR" Name="lpszServiceClassName" />
            <Param Type="LPDWORD" Name="lpdwBufferLength" />
            <Return Type="[SocketCode-INT]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSAHtonl" Ordinal="70">
            <Param Type="SOCKET" Name="s" />
            <Param Type="u_long" Name="hostlong" />
            <Param Type="u_long*" Name="lpnetlong" />
            <Return Type="int" />
        </Api>
        <Api Name="WSAHtons" Ordinal="71">
            <Param Type="SOCKET" Name="s" />
            <Param Type="u_short" Name="hostshort" />
            <Param Type="u_short*" Name="lpnetshort" />
            <Return Type="int" />
        </Api>
        <Api Name="WSAInstallServiceClass" BothCharset="True" OrdinalA="72" OrdinalW="73">
            <Param Type="LPWSASERVICECLASSINFO" Name="lpServiceClassInfo" />
            <Return Type="[SocketCode-INT]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSAIoctl" Ordinal="74">
            <Param Type="SOCKET" Name="s" />
            <Param Type="DWORD" Name="dwIoControlCode" />
            <Param Type="LPVOID" Name="lpvInBuffer" Length="cbInBuffer" />
            <Param Type="DWORD" Name="cbInBuffer" />
            <Param Type="LPVOID" Name="lpvOutBuffer" PostLength="lpcbBytesReturned" />
            <Param Type="DWORD" Name="cbOutBuffer" />
            <Param Type="LPDWORD" Name="lpcbBytesReturned" />
            <Param Type="LPWSAOVERLAPPED" Name="lpOverlapped" />
            <Param Type="LPWSAOVERLAPPED_COMPLETION_ROUTINE" Name="lpCompletionRoutine" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSAJoinLeaf" Ordinal="75">
            <Param Type="SOCKET" Name="s" />
            <Param Type="const struct sockaddr*" Name="name" />
            <Param Type="int" Name="namelen" />
            <Param Type="LPWSABUF" Name="lpCallerData" />
            <Param Type="LPWSABUF" Name="lpCalleeData" />
            <Param Type="LPQOS" Name="lpSQOS" />
            <Param Type="LPQOS" Name="lpGQOS" />
            <Param Type="DWORD" Name="dwFlags" />
            <Return Type="SOCKET" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSALookupServiceBegin" BothCharset="True" OrdinalA="76" OrdinalW="77">
            <Param Type="LPWSAQUERYSET" Name="lpqsRestrictions" />
            <Param Type="[LookupServiceFlags]" Name="dwControlFlags" />
            <Param Type="LPHANDLE" Name="lphLookup" />
            <Return Type="[SocketCode-INT]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSALookupServiceEnd" Ordinal="78">
            <Param Type="HANDLE" Name="hLookup" />
            <Return Type="[SocketCode-INT]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSALookupServiceNext" BothCharset="True" OrdinalA="79" OrdinalW="80">
            <Param Type="HANDLE" Name="hLookup" />
            <Param Type="[LookupServiceFlags]" Name="dwControlFlags" />
            <Param Type="LPDWORD" Name="lpdwBufferLength" />
            <Param Type="LPWSAQUERYSET" Name="lpqsResults" />
            <Return Type="[SocketCode-INT]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSANtohl" Ordinal="82">
            <Param Type="SOCKET" Name="s" />
            <Param Type="u_long" Name="netlong" />
            <Param Type="u_long*" Name="lphostlong" />
            <Return Type="int" />
        </Api>
        <Api Name="WSANtohs" Ordinal="83">
            <Param Type="SOCKET" Name="s" />
            <Param Type="u_short" Name="netshort" />
            <Param Type="u_short*" Name="lphostshort" />
            <Return Type="int" />
        </Api>
        <Api Name="WSAPoll" Ordinal="84">
            <Param Type="ULONG" Name="nfds" />
            <Param Type="INT" Name="timeout" />
            <Return Type="[SocketCode-int]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSAProviderConfigChange" Ordinal="86">
            <Param Type="LPHANDLE" Name="lpNotificationHandle" />
            <Param Type="LPWSAOVERLAPPED" Name="lpOverlapped" />
            <Param Type="LPWSAOVERLAPPED_COMPLETION_ROUTINE" Name="lpCompletionRoutine" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSARecv" Ordinal="87">
            <Param Type="SOCKET" Name="s" />
            <Param Type="LPWSABUF" Name="lpBuffers" />
            <Param Type="DWORD" Name="dwBufferCount" />
            <Param Type="LPDWORD" Name="lpNumberOfBytesRecvd" />
            <Param Type="[SendRecvFlags*]" Name="lpFlags" />
            <Param Type="LPWSAOVERLAPPED" Name="lpOverlapped" />
            <Param Type="LPWSAOVERLAPPED_COMPLETION_ROUTINE" Name="lpCompletionRoutine" />
            <Return Type="[SocketCode-int]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSARecvDisconnect" Ordinal="88">
            <Param Type="SOCKET" Name="s" />
            <Param Type="LPWSABUF" Name="lpInboundDisconnectData" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSARecvFrom" Ordinal="89">
            <Param Type="SOCKET" Name="s" />
            <Param Type="LPWSABUF" Name="lpBuffers" />
            <Param Type="DWORD" Name="dwBufferCount" />
            <Param Type="LPDWORD" Name="lpNumberOfBytesRecvd" />
            <Param Type="LPDWORD" Name="lpFlags" />
            <Param Type="struct sockaddr*" Name="lpFrom" />
            <Param Type="LPINT" Name="lpFromlen" />
            <Param Type="LPWSAOVERLAPPED" Name="lpOverlapped" />
            <Param Type="LPWSAOVERLAPPED_COMPLETION_ROUTINE" Name="lpCompletionRoutine" />
            <Return Type="[SocketCode-int]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSARemoveServiceClass" Ordinal="90">
            <Param Type="LPGUID" Name="lpServiceClassId" />
            <Return Type="[SocketCode-INT]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSAResetEvent" Ordinal="91">
            <Param Type="WSAEVENT" Name="hEvent" />
            <Return Type="BOOL" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="WSASend" Ordinal="92">
            <Param Type="SOCKET" Name="s" />
            <Param Type="LPWSABUF" Name="lpBuffers" />
            <Param Type="DWORD" Name="dwBufferCount" />
            <Param Type="LPDWORD" Name="lpNumberOfBytesSent" />
            <Param Type="[SendRecvFlags]" Name="dwFlags" />
            <Param Type="LPWSAOVERLAPPED" Name="lpOverlapped" />
            <Param Type="LPWSAOVERLAPPED_COMPLETION_ROUTINE" Name="lpCompletionRoutine" />
            <Return Type="[SocketCode-int]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSASendDisconnect" Ordinal="93">
            <Param Type="SOCKET" Name="s" />
            <Param Type="LPWSABUF" Name="lpOutboundDisconnectData" />
            <Return Type="[SocketCode-int]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSASendMsg" Ordinal="94">
            <Param Type="SOCKET" Name="s" />
            <Param Type="LPWSAMSG" Name="lpMsg" />
            <Param Type="DWORD" Name="dwFlags" />
            <Param Type="LPDWORD" Name="lpNumberOfBytesSent" />
            <Param Type="LPWSAOVERLAPPED" Name="lpOverlapped" />
            <Param Type="LPWSAOVERLAPPED_COMPLETION_ROUTINE" Name="lpCompletionRoutine" />
            <Return Type="[SocketCode-int]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSASendTo" Ordinal="95">
            <Param Type="SOCKET" Name="s" />
            <Param Type="LPWSABUF" Name="lpBuffers" />
            <Param Type="DWORD" Name="dwBufferCount" />
            <Param Type="LPDWORD" Name="lpNumberOfBytesSent" />
            <Param Type="[SendRecvFlags]" Name="dwFlags" />
            <Param Type="const struct sockaddr*" Name="lpTo" />
            <Param Type="int" Name="iToLen" />
            <Param Type="LPWSAOVERLAPPED" Name="lpOverlapped" />
            <Param Type="LPWSAOVERLAPPED_COMPLETION_ROUTINE" Name="lpCompletionRoutine" />
            <Return Type="[SocketCode-int]" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSASetEvent" Ordinal="96">
            <Param Type="WSAEVENT" Name="hEvent" />
            <Return Type="BOOL" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="WSASetLastError" Ordinal="112">
            <Param Type="int" Name="iError" />
            <Return Type="void" />
        </Api>
        <Api Name="WSASetService" BothCharset="True" OrdinalA="97" OrdinalW="98">
            <Param Type="LPWSAQUERYSET" Name="lpqsRegInfo" />
            <Param Type="WSAESETSERVICEOP" Name="essOperation" />
            <Param Type="DWORD" Name="dwControlFlags" />
            <Return Type="[SocketCode-INT]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSASocket" BothCharset="True" OrdinalA="99" OrdinalW="100">
            <Param Type="[AddressFamily]" Name="af" />
            <Param Type="[SocketType]" Name="type" />
            <Param Type="[SocketProtocol]" Name="protocol" />
            <Param Type="LPWSAPROTOCOL_INFO" Name="lpProtocolInfo" />
            <Param Type="GROUP" Name="g" />
            <Param Type="[WsaFlags]" Name="dwFlags" />
            <Return Type="SOCKET" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSAStartup" Ordinal="115" ErrorIsReturnValue="True">
            <Param Type="WORD" Name="wVersionRequested" />
            <Param Type="LPWSADATA" Name="lpWSAData" />
            <Return Type="int" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSAStringToAddress" BothCharset="True" OrdinalA="117" OrdinalW="118">
            <Param Type="LPTSTR" Name="AddressString" />
            <Param Type="[AddressFamily]" Name="AddressFamily" />
            <Param Type="LPWSAPROTOCOL_INFO" Name="lpProtocolInfo" PostLength="lpAddressLength" />
            <Param Type="LPSOCKADDR" Name="lpAddress" />
            <Param Type="LPINT" Name="lpAddressLength" />
            <Return Type="[SocketCode-INT]" />
            <Success Return="Equal" Value="0" />
        </Api>
        <Api Name="WSAWaitForMultipleEvents" Ordinal="120">
            <Param Type="DWORD" Name="cEvents" />
            <Param Type="const WSAEVENT*" Name="lphEvents" />
            <Param Type="BOOL" Name="fWaitAll" />
            <Param Type="DWORD" Name="dwTimeout" />
            <Param Type="BOOL" Name="fAlertable" />
            <Return Type="DWORD" />
            <Success Return="NotEqual" Value="-1" />
        </Api>
        <Api Name="WSAIsBlocking" Ordinal="114">
            <Return Type="BOOL" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        
        <!-- Quality of Service (QOS) -->
        <Category Name="Networking/Network Protocols/Quality of Service (QOS)" />
        <Api Name="WSAGetQOSByName">
            <Param Type="SOCKET" Name="s" />
            <Param Type="LPWSABUF" Name="lpQOSName" />
            <Param Type="LPQOS" Name="lpQOS" />
            <Return Type="BOOL" />
            <Success Return="NotEqual" Value="0" />
        </Api>
    </Module>
</ApiMonitor>