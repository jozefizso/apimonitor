<!--
    API Monitor Definitions
    (c) 2010-2012, Rohitab Batra <rohitab@rohitab.com>
    http://www.rohitab.com/apimonitor/
-->
<ApiMonitor>
    <Include Filename="Headers\windows.h.xml" />
    <Include Filename="Headers\security.h.xml" />
    
    <Module Name="Secur32.dll" CallingConvention="STDCALL" ErrorFunc="GetLastError" OnlineHelp="MSDN">
        <!-- Variables -->
        <Variable Name="SEC_CHAR*"                  Type="Alias"    Base="CHAR*" />
        <Variable Name="SEC_WCHAR*"                 Type="Alias"    Base="WCHAR*" />
        <Variable Name="SEC_TCHAR*"                 Type="Alias"    Base="TCHAR*" />
        <Variable Name="void SEC_FAR*"              Type="Alias"    Base="LPVOID" />
        <Variable Name="SECURITY_STRING"            Type="Alias"    Base="UNICODE_STRING" />
        <Variable Name="PSECURITY_STRING"           Type="Pointer"  Base="SECURITY_STRING" />
        <Variable Name="LSA_STRING"                 Type="Alias"    Base="STRING" />
        <Variable Name="PLSA_STRING"                Type="Pointer"  Base="LSA_STRING" />
        <Variable Name="TimeStamp"                  Type="Alias"    Base="LARGE_INTEGER" />
        <Variable Name="PTimeStamp"                 Type="Pointer"  Base="TimeStamp" />
        <Variable Name="SEC_GET_KEY_FN"             Type="Alias"    Base="LPVOID" />

        <!-- TODO: Structures (Complex) -->
        <Variable Name="PSecurityFunctionTable"             Type="Alias"    Base="LPVOID" />

        <!-- SECURITY_LOGON_TYPE -->
        <Variable Name="SECURITY_LOGON_TYPE" Type="Alias" Base="DWORD">
            <Enum>
                <Set Name="UndefinedLogonType"          Value="0" />
                <!-- Interactive Starts at 2 -->
                <Set Name="Interactive"                 Value="2" />
                <Set Name="Network"                     Value="3" />
                <Set Name="Batch"                       Value="4" />
                <Set Name="Service"                     Value="5" />
                <Set Name="Proxy"                       Value="6" />
                <Set Name="Unlock"                      Value="7" />
                <Set Name="NetworkCleartext"            Value="8" />
                <Set Name="NewCredentials"              Value="9" />
                <Set Name="RemoteInteractive"           Value="10" />
                <Set Name="CachedInteractive"           Value="11" />
                <Set Name="CachedRemoteInteractive"     Value="12" />
                <Set Name="CachedUnlock"                Value="13" />
            </Enum>
        </Variable>

        <!-- LSA_LAST_INTER_LOGON_INFO -->
        <Variable Name="LSA_LAST_INTER_LOGON_INFO" Type="Struct">
            <Field Type="LARGE_INTEGER"     Name="LastSuccessfulLogon" />
            <Field Type="LARGE_INTEGER"     Name="LastFailedLogon" />
            <Field Type="ULONG"             Name="FailedAttemptCountSinceLastSuccessfulLogon" />
        </Variable>

        <!-- SECURITY_LOGON_SESSION_DATA -->
        <Variable Name="SECURITY_LOGON_SESSION_DATA" Type="Struct">
            <Field Type="ULONG"                         Name="Size" />
            <Field Type="LUID"                          Name="LogonId" />
            <Field Type="LSA_UNICODE_STRING"            Name="UserName" />
            <Field Type="LSA_UNICODE_STRING"            Name="LogonDomain" />
            <Field Type="LSA_UNICODE_STRING"            Name="AuthenticationPackage" />
            <Field Type="SECURITY_LOGON_TYPE"           Name="LogonType" Display="ULONG" />
            <Field Type="ULONG"                         Name="Session" />
            <Field Type="PSID"                          Name="Sid" />
            <Field Type="LARGE_INTEGER"                 Name="LogonTime" />
            <Field Type="LSA_UNICODE_STRING"            Name="LogonServer" />
            <Field Type="LSA_UNICODE_STRING"            Name="DnsDomainName" />
            <Field Type="LSA_UNICODE_STRING"            Name="Upn" />
            <Field Type="ULONG"                         Name="UserFlags" />
            <Field Type="LSA_LAST_INTER_LOGON_INFO"     Name="LastLogonInfo" />
            <Field Type="LSA_UNICODE_STRING"            Name="LogonScript" />
            <Field Type="LSA_UNICODE_STRING"            Name="ProfilePath" />
            <Field Type="LSA_UNICODE_STRING"            Name="HomeDirectory" />
            <Field Type="LSA_UNICODE_STRING"            Name="HomeDirectoryDrive" />
            <Field Type="LARGE_INTEGER"                 Name="LogoffTime" />
            <Field Type="LARGE_INTEGER"                 Name="KickOffTime" />
            <Field Type="LARGE_INTEGER"                 Name="PasswordLastSet" />
            <Field Type="LARGE_INTEGER"                 Name="PasswordCanChange" />
            <Field Type="LARGE_INTEGER"                 Name="PasswordMustChange" />
        </Variable>
        <Variable Name="PSECURITY_LOGON_SESSION_DATA"  Type="Pointer" Base="SECURITY_LOGON_SESSION_DATA" />
        <Variable Name="PSECURITY_LOGON_SESSION_DATA*" Type="Pointer" Base="PSECURITY_LOGON_SESSION_DATA" />

        <!-- SecPkgInfo -->
        <Variable Name="SecPkgInfo" Type="Struct">
            <Field Type="unsigned long" 	Name="fCapabilities" />
            <Field Type="unsigned short" 	Name="wVersion" />
            <Field Type="unsigned short" 	Name="wRPCID" />
            <Field Type="unsigned long" 	Name="cbMaxToken" />
            <Field Type="SEC_TCHAR*"  	    Name="Name" />
            <Field Type="SEC_TCHAR*"  	    Name="Comment" />
        </Variable>
        <Variable Name="PSecPkgInfo"  Type="Pointer" Base="SecPkgInfo" />
        <Variable Name="PSecPkgInfo*" Type="Pointer" Base="PSecPkgInfo" />

        <!-- SecBuffer -->
        <Variable Name="SecBuffer" Type="Struct">
            <Field Type="unsigned long" 	Name="cbBuffer" />
            <Field Type="unsigned long" 	Name="BufferType" />
            <Field Type="void SEC_FAR*"		Name="pvBuffer" />
        </Variable>
        <Variable Name="PSecBuffer" Type="Pointer" Base="SecBuffer" />

        <!-- CredHandle-->
        <Variable Name="CredHandle"         Type="Alias"    Base="SecHandle" />
        <Variable Name="PCredHandle"        Type="Pointer"  Base="CredHandle" />

        <!-- SecBufferDesc -->
        <Variable Name="SecBufferDesc" Type="Struct">
            <Field Type="unsigned long"     Name="ulVersion" />
            <Field Type="unsigned long"     Name="cBuffers" />
            <Field Type="PSecBuffer" 	    Name="pBuffers" />
        </Variable>
        <Variable Name="PSecBufferDesc" Type="Pointer" Base="SecBufferDesc" />

        <!-- SECURITY_PACKAGE_OPTIONS -->
        <Variable Name="SECURITY_PACKAGE_OPTIONS" Type="Struct">
            <Field Type="unsigned long"   	Name="Size" />
            <Field Type="unsigned long"   	Name="Type" />
            <Field Type="unsigned long"   	Name="Flags" />
            <Field Type="unsigned long"   	Name="SignatureSize" />
            <Field Type="void*"             Name="Signature" />
        </Variable>
        <Variable Name="PSECURITY_PACKAGE_OPTIONS" Type="Pointer" Base="SECURITY_PACKAGE_OPTIONS" />

        <Variable Name="EXTENDED_NAME_FORMAT" Type="Alias" Base="UINT">
            <Enum>
                <Set Name="NameUnknown"             Value="0" />
                <Set Name="NameFullyQualifiedDN"    Value="1" />
                <Set Name="NameSamCompatible"       Value="2" />
                <Set Name="NameDisplay"             Value="3" />
                <Set Name="NameUniqueId"            Value="6" />
                <Set Name="NameCanonical"           Value="7" />
                <Set Name="NameUserPrincipal"       Value="8" />
                <Set Name="NameCanonicalEx"         Value="9" />
                <Set Name="NameServicePrincipal"    Value="10" />
                <Set Name="NameDnsDomain"           Value="12" />
            </Enum>
        </Variable>

        <Variable Name="POLICY_NOTIFICATION_INFORMATION_CLASS" Type="Alias" Base="UINT">
            <Enum>
                <Set Name="PolicyNotifyAuditEventsInformation"              Value="1" />
                <Set Name="PolicyNotifyAccountDomainInformation"            Value="2" />
                <Set Name="PolicyNotifyServerRoleInformation"               Value="3" />
                <Set Name="PolicyNotifyDnsDomainInformation"                Value="4" />
                <Set Name="PolicyNotifyDomainEfsInformation"                Value="5" />
                <Set Name="PolicyNotifyDomainKerberosTicketInformation"     Value="6" />
                <Set Name="PolicyNotifyMachineAccountPasswordInformation"   Value="7" />
            </Enum>
        </Variable>

        <Variable Name="LSA_OPERATIONAL_MODE" Type="Alias" Base="ULONG">
            <Flag>
                <Set Name="LSA_MODE_PASSWORD_PROTECTED"     Value="0x00000001" />
                <Set Name="LSA_MODE_INDIVIDUAL_ACCOUNTS"    Value="0x00000002" />
                <Set Name="LSA_MODE_MANDATORY_ACCESS"       Value="0x00000004" />
                <Set Name="LSA_MODE_LOG_FULL"               Value="0x00000008" />
            </Flag>
        </Variable>
        <Variable Name="PLSA_OPERATIONAL_MODE"  Type="Pointer"  Base="LSA_OPERATIONAL_MODE" />

        <Variable Name="[SecCredentialUse]" Type="Alias" Base="DWORD">
            <Display Name="ULONG" />
            <Enum>
                <Set Name="SECPKG_CRED_INBOUND"         		Value="0x00000001" />
                <Set Name="SECPKG_CRED_OUTBOUND"        		Value="0x00000002" />
                <Set Name="SECPKG_CRED_BOTH"            		Value="0x00000003" />
                <Set Name="SECPKG_CRED_DEFAULT"         		Value="0x00000004" />
                <Set Name="SECPKG_CRED_RESERVED"        		Value="0xF0000000" />
                <Set Name="SECPKG_CRED_AUTOLOGON_RESTRICTED"    Value="0x00000010" />
                <Set Name="SECPKG_CRED_PROCESS_POLICY_ONLY"     Value="0x00000020" />
            </Enum>
        </Variable>

        <Variable Name="[InitializeSecurityContextRequestFlags]" Type="Alias" Base="unsigned long">
            <Display Name="unsigned long" />
            <Flag>
                <Set Name="ISC_REQ_DELEGATE"                	Value="0x00000001" />
                <Set Name="ISC_REQ_MUTUAL_AUTH"             	Value="0x00000002" />
                <Set Name="ISC_REQ_REPLAY_DETECT"           	Value="0x00000004" />
                <Set Name="ISC_REQ_SEQUENCE_DETECT"         	Value="0x00000008" />
                <Set Name="ISC_REQ_CONFIDENTIALITY"         	Value="0x00000010" />
                <Set Name="ISC_REQ_USE_SESSION_KEY"         	Value="0x00000020" />
                <Set Name="ISC_REQ_PROMPT_FOR_CREDS"        	Value="0x00000040" />
                <Set Name="ISC_REQ_USE_SUPPLIED_CREDS"      	Value="0x00000080" />
                <Set Name="ISC_REQ_ALLOCATE_MEMORY"         	Value="0x00000100" />
                <Set Name="ISC_REQ_USE_DCE_STYLE"           	Value="0x00000200" />
                <Set Name="ISC_REQ_DATAGRAM"                	Value="0x00000400" />
                <Set Name="ISC_REQ_CONNECTION"              	Value="0x00000800" />
                <Set Name="ISC_REQ_CALL_LEVEL"              	Value="0x00001000" />
                <Set Name="ISC_REQ_FRAGMENT_SUPPLIED"       	Value="0x00002000" />
                <Set Name="ISC_REQ_EXTENDED_ERROR"          	Value="0x00004000" />
                <Set Name="ISC_REQ_STREAM"                  	Value="0x00008000" />
                <Set Name="ISC_REQ_INTEGRITY"               	Value="0x00010000" />
                <Set Name="ISC_REQ_IDENTIFY"                	Value="0x00020000" />
                <Set Name="ISC_REQ_NULL_SESSION"            	Value="0x00040000" />
                <Set Name="ISC_REQ_MANUAL_CRED_VALIDATION"      Value="0x00080000" />
                <Set Name="ISC_REQ_RESERVED1"               	Value="0x00100000" />
                <Set Name="ISC_REQ_FRAGMENT_TO_FIT"         	Value="0x00200000" />
                <Set Name="ISC_REQ_FORWARD_CREDENTIALS"     	Value="0x00400000" />
                <Set Name="ISC_REQ_NO_INTEGRITY"            	Value="0x00800000" />
                <Set Name="ISC_REQ_USE_HTTP_STYLE"          	Value="0x01000000" />
            </Flag>
        </Variable>

        <Variable Name="[InitializeSecurityContextRetFlags]" Type="Alias" Base="ULONG">
            <Display Name="ULONG" />
            <Flag>
                <Set Name="ISC_RET_DELEGATE"                	Value="0x00000001" />
                <Set Name="ISC_RET_MUTUAL_AUTH"             	Value="0x00000002" />
                <Set Name="ISC_RET_REPLAY_DETECT"           	Value="0x00000004" />
                <Set Name="ISC_RET_SEQUENCE_DETECT"         	Value="0x00000008" />
                <Set Name="ISC_RET_CONFIDENTIALITY"         	Value="0x00000010" />
                <Set Name="ISC_RET_USE_SESSION_KEY"         	Value="0x00000020" />
                <Set Name="ISC_RET_USED_COLLECTED_CREDS"    	Value="0x00000040" />
                <Set Name="ISC_RET_USED_SUPPLIED_CREDS"     	Value="0x00000080" />
                <Set Name="ISC_RET_ALLOCATED_MEMORY"        	Value="0x00000100" />
                <Set Name="ISC_RET_USED_DCE_STYLE"          	Value="0x00000200" />
                <Set Name="ISC_RET_DATAGRAM"                	Value="0x00000400" />
                <Set Name="ISC_RET_CONNECTION"              	Value="0x00000800" />
                <Set Name="ISC_RET_INTERMEDIATE_RETURN"     	Value="0x00001000" />
                <Set Name="ISC_RET_CALL_LEVEL"              	Value="0x00002000" />
                <Set Name="ISC_RET_EXTENDED_ERROR"          	Value="0x00004000" />
                <Set Name="ISC_RET_STREAM"                  	Value="0x00008000" />
                <Set Name="ISC_RET_INTEGRITY"               	Value="0x00010000" />
                <Set Name="ISC_RET_IDENTIFY"                	Value="0x00020000" />
                <Set Name="ISC_RET_NULL_SESSION"            	Value="0x00040000" />
                <Set Name="ISC_RET_MANUAL_CRED_VALIDATION"      Value="0x00080000" />
                <Set Name="ISC_RET_RESERVED1"               	Value="0x00100000" />
                <Set Name="ISC_RET_FRAGMENT_ONLY"           	Value="0x00200000" />
                <Set Name="ISC_RET_FORWARD_CREDENTIALS"     	Value="0x00400000" />
                <Set Name="ISC_RET_USED_HTTP_STYLE"         	Value="0x01000000" />
                <Set Name="ISC_RET_NO_ADDITIONAL_TOKEN"         Value="0x02000000" />
                <Set Name="ISC_RET_REAUTHENTICATION"        	Value="0x08000000" />
            </Flag>
        </Variable>
        <Variable Name="[InitializeSecurityContextRetFlags*]" Type="Pointer" Base="[InitializeSecurityContextRetFlags]">
            <Display Name="PULONG" />
        </Variable>
        <Variable Name="[InitializeSecurityContextRetFlags-unsigned-long]" Type="Pointer" Base="[InitializeSecurityContextRetFlags]">
            <Display Name="unsigned long" />
        </Variable>
        <Variable Name="[InitializeSecurityContextRetFlags-unsigned-long*]" Type="Pointer" Base="[InitializeSecurityContextRetFlags-unsigned-long]">
            <Display Name="unsigned long*" />
        </Variable>

        <Variable Name="[AcceptSecurityContextRequestFlags]" Type="Alias" Base="unsigned long">
            <Display Name="unsigned long" />
            <Flag>
                <Set Name="ASC_REQ_DELEGATE"                	Value="0x00000001" />
                <Set Name="ASC_REQ_MUTUAL_AUTH"             	Value="0x00000002" />
                <Set Name="ASC_REQ_REPLAY_DETECT"           	Value="0x00000004" />
                <Set Name="ASC_REQ_SEQUENCE_DETECT"         	Value="0x00000008" />
                <Set Name="ASC_REQ_CONFIDENTIALITY"         	Value="0x00000010" />
                <Set Name="ASC_REQ_USE_SESSION_KEY"         	Value="0x00000020" />
                <Set Name="ASC_REQ_ALLOCATE_MEMORY"         	Value="0x00000100" />
                <Set Name="ASC_REQ_USE_DCE_STYLE"           	Value="0x00000200" />
                <Set Name="ASC_REQ_DATAGRAM"                	Value="0x00000400" />
                <Set Name="ASC_REQ_CONNECTION"              	Value="0x00000800" />
                <Set Name="ASC_REQ_CALL_LEVEL"              	Value="0x00001000" />
                <Set Name="ASC_REQ_EXTENDED_ERROR"          	Value="0x00008000" />
                <Set Name="ASC_REQ_STREAM"                  	Value="0x00010000" />
                <Set Name="ASC_REQ_INTEGRITY"               	Value="0x00020000" />
                <Set Name="ASC_REQ_LICENSING"               	Value="0x00040000" />
                <Set Name="ASC_REQ_IDENTIFY"                	Value="0x00080000" />
                <Set Name="ASC_REQ_ALLOW_NULL_SESSION"      	Value="0x00100000" />
                <Set Name="ASC_REQ_ALLOW_NON_USER_LOGONS"   	Value="0x00200000" />
                <Set Name="ASC_REQ_ALLOW_CONTEXT_REPLAY"    	Value="0x00400000" />
                <Set Name="ASC_REQ_FRAGMENT_TO_FIT"         	Value="0x00800000" />
                <Set Name="ASC_REQ_FRAGMENT_SUPPLIED"       	Value="0x00002000" />
                <Set Name="ASC_REQ_NO_TOKEN"                	Value="0x01000000" />
                <Set Name="ASC_REQ_PROXY_BINDINGS"          	Value="0x04000000" />
                <Set Name="ASC_REQ_ALLOW_MISSING_BINDINGS"      Value="0x10000000" />
            </Flag>
        </Variable>

        <Variable Name="[AcceptSecurityContextRetFlags]" Type="Alias" Base="unsigned long">
            <Display Name="unsigned long" />
            <Flag>
                <Set Name="ASC_RET_DELEGATE"                		Value="0x00000001" />
                <Set Name="ASC_RET_MUTUAL_AUTH"             		Value="0x00000002" />
                <Set Name="ASC_RET_REPLAY_DETECT"           		Value="0x00000004" />
                <Set Name="ASC_RET_SEQUENCE_DETECT"         		Value="0x00000008" />
                <Set Name="ASC_RET_CONFIDENTIALITY"         		Value="0x00000010" />
                <Set Name="ASC_RET_USE_SESSION_KEY"         		Value="0x00000020" />
                <Set Name="ASC_RET_ALLOCATED_MEMORY"        		Value="0x00000100" />
                <Set Name="ASC_RET_USED_DCE_STYLE"          		Value="0x00000200" />
                <Set Name="ASC_RET_DATAGRAM"                		Value="0x00000400" />
                <Set Name="ASC_RET_CONNECTION"              		Value="0x00000800" />
                <Set Name="ASC_RET_CALL_LEVEL"              		Value="0x00002000" />
                <Set Name="ASC_RET_THIRD_LEG_FAILED"        		Value="0x00004000" />
                <Set Name="ASC_RET_EXTENDED_ERROR"          		Value="0x00008000" />
                <Set Name="ASC_RET_STREAM"                  		Value="0x00010000" />
                <Set Name="ASC_RET_INTEGRITY"               		Value="0x00020000" />
                <Set Name="ASC_RET_LICENSING"               		Value="0x00040000" />
                <Set Name="ASC_RET_IDENTIFY"                		Value="0x00080000" />
                <Set Name="ASC_RET_NULL_SESSION"            		Value="0x00100000" />
                <Set Name="ASC_RET_ALLOW_NON_USER_LOGONS"   		Value="0x00200000" />
                <Set Name="ASC_RET_ALLOW_CONTEXT_REPLAY"    		Value="0x00400000" />
                <Set Name="ASC_RET_FRAGMENT_ONLY"           		Value="0x00800000" />
                <Set Name="ASC_RET_NO_TOKEN"                		Value="0x01000000" />
                <Set Name="ASC_RET_NO_ADDITIONAL_TOKEN"     		Value="0x02000000" />
                <Set Name="ASC_RET_NO_PROXY_BINDINGS"       		Value="0x04000000" />
                <Set Name="SSP_RET_REAUTHENTICATION"        		Value="0x08000000" />
                <Set Name="ASC_RET_MISSING_BINDINGS"        		Value="0x10000000" />
            </Flag>
        </Variable>
        <Variable Name="[AcceptSecurityContextRetFlags*]" Type="Pointer" Base="[AcceptSecurityContextRetFlags]">
            <Display Name="unsigned long*" />
        </Variable>

        <Variable Name="[SecContextAttr]" Type="Alias" Base="ULONG">
            <Display Name="ULONG" />
            <Enum>
                <Set Name="SECPKG_ATTR_SIZES"           		    Value="0" />
                <Set Name="SECPKG_ATTR_NAMES"           		    Value="1" />
                <Set Name="SECPKG_ATTR_LIFESPAN"        		    Value="2" />
                <Set Name="SECPKG_ATTR_DCE_INFO"        		    Value="3" />
                <Set Name="SECPKG_ATTR_STREAM_SIZES"    		    Value="4" />
                <Set Name="SECPKG_ATTR_KEY_INFO"        	    	Value="5" />
                <Set Name="SECPKG_ATTR_AUTHORITY"       	    	Value="6" />
                <Set Name="SECPKG_ATTR_PROTO_INFO"      	    	Value="7" />
                <Set Name="SECPKG_ATTR_PASSWORD_EXPIRY" 	    	Value="8" />
                <Set Name="SECPKG_ATTR_SESSION_KEY"     	    	Value="9" />
                <Set Name="SECPKG_ATTR_PACKAGE_INFO"    	    	Value="10" />
                <Set Name="SECPKG_ATTR_USER_FLAGS"      	    	Value="11" />
                <Set Name="SECPKG_ATTR_NEGOTIATION_INFO" 	    	Value="12" />
                <Set Name="SECPKG_ATTR_NATIVE_NAMES"    	    	Value="13" />
                <Set Name="SECPKG_ATTR_FLAGS"           	    	Value="14" />
                <Set Name="SECPKG_ATTR_USE_VALIDATED"   	    	Value="15" />
                <Set Name="SECPKG_ATTR_CREDENTIAL_NAME" 	    	Value="16" />
                <Set Name="SECPKG_ATTR_TARGET_INFORMATION" 	    	Value="17" />
                <Set Name="SECPKG_ATTR_ACCESS_TOKEN"    	    	Value="18" />
                <Set Name="SECPKG_ATTR_TARGET"          	    	Value="19" />
                <Set Name="SECPKG_ATTR_AUTHENTICATION_ID"  	    	Value="20" />
                <Set Name="SECPKG_ATTR_LOGOFF_TIME"     	    	Value="21" />
                <Set Name="SECPKG_ATTR_NEGO_KEYS"         	    	Value="22" />
                <Set Name="SECPKG_ATTR_PROMPTING_NEEDED"  	    	Value="24" />
                <Set Name="SECPKG_ATTR_UNIQUE_BINDINGS"   	    	Value="25" />
                <Set Name="SECPKG_ATTR_ENDPOINT_BINDINGS" 	    	Value="26" />
                <Set Name="SECPKG_ATTR_CLIENT_SPECIFIED_TARGET" 	Value="27" />
                <Set Name="SECPKG_ATTR_LAST_CLIENT_TOKEN_STATUS" 	Value="30" />
                <Set Name="SECPKG_ATTR_NEGO_PKG_INFO"        		Value="31" />
                <Set Name="SECPKG_ATTR_NEGO_STATUS"          		Value="32" />
                <Set Name="SECPKG_ATTR_CONTEXT_DELETED"      		Value="33" />
                <Set Name="SECPKG_ATTR_ISSUER_LIST"          		Value="0x50" />
                <Set Name="SECPKG_ATTR_REMOTE_CRED"          		Value="0x51" />
                <Set Name="SECPKG_ATTR_LOCAL_CRED"           		Value="0x52" />
                <Set Name="SECPKG_ATTR_REMOTE_CERT_CONTEXT"  		Value="0x53" />
                <Set Name="SECPKG_ATTR_LOCAL_CERT_CONTEXT"   		Value="0x54" />
                <Set Name="SECPKG_ATTR_ROOT_STORE"           		Value="0x55" />
                <Set Name="SECPKG_ATTR_SUPPORTED_ALGS"       		Value="0x56" />
                <Set Name="SECPKG_ATTR_CIPHER_STRENGTHS"     		Value="0x57" />
                <Set Name="SECPKG_ATTR_SUPPORTED_PROTOCOLS"  		Value="0x58" />
                <Set Name="SECPKG_ATTR_ISSUER_LIST_EX"       		Value="0x59" />
                <Set Name="SECPKG_ATTR_CONNECTION_INFO"      		Value="0x5a" />
                <Set Name="SECPKG_ATTR_EAP_KEY_BLOCK"        		Value="0x5b" />
                <Set Name="SECPKG_ATTR_MAPPED_CRED_ATTR"     		Value="0x5c" />
                <Set Name="SECPKG_ATTR_SESSION_INFO"         		Value="0x5d" />
                <Set Name="SECPKG_ATTR_APP_DATA"             		Value="0x5e" />
                <Set Name="SECPKG_ATTR_REMOTE_CERTIFICATES"  		Value="0x5F" />
                <Set Name="SECPKG_ATTR_CLIENT_CERT_POLICY"   		Value="0x60" />
                <Set Name="SECPKG_ATTR_CC_POLICY_RESULT"     		Value="0x61" />
                <Set Name="SECPKG_ATTR_USE_NCRYPT"           		Value="0x62" />
                <Set Name="SECPKG_ATTR_LOCAL_CERT_INFO"      		Value="0x63" />
                <Set Name="SECPKG_ATTR_CIPHER_INFO"          		Value="0x64" />
                <Set Name="SECPKG_ATTR_EAP_PRF_INFO"         		Value="0x65" />
                <Set Name="SECPKG_ATTR_SUPPORTED_SIGNATURES" 		Value="0x66" />
                <Set Name="SECPKG_ATTR_SUBJECT_SECURITY_ATTRIBUTES" Value="128" />
            </Enum>
        </Variable>

        <!-- System Information -->
        <Category Name="System Services/Windows System Information/System Information" />
        <Api Name="GetComputerObjectName" BothCharset="True">
            <Param Type="EXTENDED_NAME_FORMAT" Name="NameFormat" />
            <Param Type="LPTSTR" Name="lpNameBuffer" />
            <Param Type="PULONG" Name="lpnSize" />
            <Return Type="BOOLEAN" />
        </Api>
        <Api Name="GetUserNameEx" BothCharset="True">
            <Param Type="EXTENDED_NAME_FORMAT" Name="NameFormat" />
            <Param Type="LPTSTR" Name="lpNameBuffer" />
            <Param Type="PULONG" Name="lpnSize" />
            <Return Type="BOOLEAN" />
        </Api>
        <Api Name="TranslateName" BothCharset="True">
            <Param Type="LPCTSTR" Name="lpAccountName" />
            <Param Type="EXTENDED_NAME_FORMAT" Name="AccountNameFormat" />
            <Param Type="EXTENDED_NAME_FORMAT" Name="DesiredNameFormat" />
            <Param Type="LPTSTR" Name="lpTranslatedName" />
            <Param Type="PULONG" Name="nSize" />
            <Return Type="BOOLEAN" />
        </Api>
        
        <!-- Security Support Provider Interface (SSPI) -->
        <Category Name="Security and Identity/Authentication/Security Support Provider Interface (SSPI)/Package Management" />
        <Api Name="EnumerateSecurityPackages" BothCharset="True">
            <Param Type="PULONG" Name="pcPackages" />
            <Param Type="PSecPkgInfo*" Name="ppPackageInfo" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="InitSecurityInterface" BothCharset="True">
            <Return Type="PSecurityFunctionTable" />
            <Success Return="NotEqual" Value="0" />
        </Api>
        <Api Name="QuerySecurityPackageInfo" BothCharset="True">
            <Param Type="SEC_CHAR*" Name="pszPackageName" />
            <Param Type="PSecPkgInfo*" Name="ppPackageInfo" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        
        <!-- Credential Management -->
        <Category Name="Security and Identity/Authentication/Security Support Provider Interface (SSPI)/Credential Management" />
        <Api Name="AcquireCredentialsHandle" BothCharset="True">
            <Param Type="SEC_CHAR*" Name="pszPrincipal" />
            <Param Type="SEC_CHAR*" Name="pszPackage" />
            <Param Type="[SecCredentialUse]" Name="fCredentialUse" />
            <Param Type="PLUID" Name="pvLogonID" />
            <Param Type="PVOID" Name="pAuthData" />
            <Param Type="SEC_GET_KEY_FN" Name="pGetKeyFn" />
            <Param Type="PVOID" Name="pvGetKeyArgument" />
            <Param Type="PCredHandle" Name="phCredential" />
            <Param Type="PTimeStamp" Name="ptsExpiry" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="ExportSecurityContext">
            <Param Type="PCtxtHandle" Name="phContext" />
            <Param Type="Ulong" Name="fFlags" />
            <Param Type="PSecBuffer" Name="pPackedContext" />
            <Param Type="HANDLE*" Name="pToken" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="FreeCredentialsHandle">
            <Param Type="PCredHandle" Name="phCredential" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="ImportSecurityContext" BothCharset="True">
            <Param Type="PSECURITY_STRING" Name="pszPackage" />
            <Param Type="PSecBuffer" Name="pPackedContext" />
            <Param Type="HANDLE" Name="pToken" />
            <Param Type="PCtxtHandle" Name="phContext" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="QueryCredentialsAttributes" BothCharset="True">
            <Param Type="PCredHandle" Name="phCredential" />
            <Param Type="ULONG" Name="ulAttribute" />
            <Param Type="PVOID" Name="pBuffer" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        
        <!-- Context Management -->
        <Category Name="Security and Identity/Authentication/Security Support Provider Interface (SSPI)/Context Management" />
        <Api Name="AcceptSecurityContext">
            <Param Type="PCredHandle" Name="phCredential" />
            <Param Type="PCtxtHandle" Name="phContext" />
            <Param Type="PSecBufferDesc" Name="pInput" />
            <Param Type="[AcceptSecurityContextRequestFlags]" Name="fContextReq" />
            <Param Type="ULONG" Name="TargetDataRep" />
            <Param Type="PCtxtHandle" Name="phNewContext" />
            <Param Type="PSecBufferDesc" Name="pOutput" />
            <Param Type="[AcceptSecurityContextRetFlags*]" Name="pfContextAttr" />
            <Param Type="PTimeStamp" Name="ptsTimeStamp" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="ApplyControlToken">
            <Param Type="PCtxtHandle" Name="phContext" />
            <Param Type="PSecBufferDesc" Name="pInput" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="CompleteAuthToken">
            <Param Type="PCtxtHandle" Name="phContext" />
            <Param Type="PSecBufferDesc" Name="pToken" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="DeleteSecurityContext">
            <Param Type="PCtxtHandle" Name="phContext" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="FreeContextBuffer">
            <Param Type="PVOID" Name="pvContextBuffer" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="ImpersonateSecurityContext">
            <Param Type="PCtxtHandle" Name="phContext" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="InitializeSecurityContext" BothCharset="True">
            <Param Type="PCredHandle" Name="phCredential" />
            <Param Type="PCtxtHandle" Name="phContext" />
            <Param Type="SEC_CHAR*" Name="pszTargetName" />
            <Param Type="[InitializeSecurityContextRequestFlags]" Display="ULONG" Name="fContextReq" />
            <Param Type="ULONG" Name="Reserved1" />
            <Param Type="ULONG" Name="TargetDataRep" />
            <Param Type="PSecBufferDesc" Name="pInput" />
            <Param Type="ULONG" Name="Reserved2" />
            <Param Type="PCtxtHandle" Name="phNewContext" />
            <Param Type="PSecBufferDesc" Name="pOutput" />
            <Param Type="[InitializeSecurityContextRetFlags*]" Name="pfContextAttr" />
            <Param Type="PTimeStamp" Name="ptsExpiry" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="QueryContextAttributes" BothCharset="True">
            <Param Type="PCtxtHandle" Name="phContext" />
            <Param Type="[SecContextAttr]" Name="ulAttribute" />
            <Param Type="PVOID" Name="pBuffer" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="QuerySecurityContextToken">
            <Param Type="PCtxtHandle" Name="phContext" />
            <Param Type="HANDLE*" Name="phToken" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="SetContextAttributes" BothCharset="True">
            <Param Type="PCtxtHandle" Name="phContext" />
            <Param Type="[SecContextAttr]" Name="ulAttribute" />
            <Param Type="void*" Name="pBuffer" Length="cbBuffer" />
            <Param Type="ULONG" Name="cbBuffer" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="RevertSecurityContext">
            <Param Type="PCtxtHandle" Name="phContext" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        
        <!-- Message Support -->
        <Category Name="Security and Identity/Authentication/Security Support Provider Interface (SSPI)/Message Support" />
        <Api Name="DecryptMessage">
            <Param Type="PCtxtHandle" Name="phContext" />
            <Param Type="PSecBufferDesc" Name="pMessage" />
            <Param Type="ULONG" Name="MessageSeqNo" />
            <Param Type="PULONG" Name="pfQOP" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="EncryptMessage">
            <Param Type="PCtxtHandle" Name="phContext" />
            <Param Type="ULONG" Name="fQOP" />
            <Param Type="PSecBufferDesc" Name="pMessage" />
            <Param Type="ULONG" Name="MessageSeqNo" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="MakeSignature">
            <Param Type="PCtxtHandle" Name="phContext" />
            <Param Type="ULONG" Name="fQOP" />
            <Param Type="PSecBufferDesc" Name="pMessage" />
            <Param Type="ULONG" Name="MessageSeqNo" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="VerifySignature">
            <Param Type="PCtxtHandle" Name="phContext" />
            <Param Type="PSecBufferDesc" Name="pMessage" />
            <Param Type="ULONG" Name="MessageSeqNo" />
            <Param Type="PULONG" Name="pfQOP" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        
        <!-- Local Security Authority (LSA) Logon -->
        <Category Name="Security and Identity/Authentication/Local Security Authority (LSA) Logon" />
        <Api Name="LsaCallAuthenticationPackage">
            <Param Type="HANDLE" Name="LsaHandle" />
            <Param Type="ULONG" Name="AuthenticationPackage" />
            <Param Type="PVOID" Name="ProtocolSubmitBuffer" Length="SubmitBufferLength" />
            <Param Type="ULONG" Name="SubmitBufferLength" />
            <Param Type="PVOID*" Name="ProtocolReturnBuffer" PostLength="ReturnBufferLength" />
            <Param Type="PULONG" Name="ReturnBufferLength" />
            <Param Type="PNTSTATUS" Name="ProtocolStatus" />
            <Return Type="NTSTATUS" />
        </Api>
        <Api Name="LsaConnectUntrusted">
            <Param Type="PHANDLE" Name="LsaHandle" />
            <Return Type="NTSTATUS" />
        </Api>
        <Api Name="LsaDeregisterLogonProcess">
            <Param Type="HANDLE" Name="LsaHandle" />
            <Return Type="NTSTATUS" />
        </Api>
        <Api Name="LsaEnumerateLogonSessions">
            <Param Type="PULONG" Name="LogonSessionCount" />
            <Param Type="PLUID*" Name="LogonSessionList" />
            <Return Type="NTSTATUS" />
        </Api>
        <Api Name="LsaFreeReturnBuffer">
            <Param Type="PVOID" Name="Buffer" />
            <Return Type="NTSTATUS" />
        </Api>
        <Api Name="LsaGetLogonSessionData">
            <Param Type="PLUID" Name="LogonId" />
            <Param Type="PSECURITY_LOGON_SESSION_DATA*" Name="ppLogonSessionData" />
            <Return Type="NTSTATUS" />
        </Api>
        <Api Name="LsaLogonUser">
            <Param Type="HANDLE" Name="LsaHandle" />
            <Param Type="PLSA_STRING" Name="OriginName" />
            <Param Type="SECURITY_LOGON_TYPE" Name="LogonType" />
            <Param Type="ULONG" Name="AuthenticationPackage" />
            <Param Type="PVOID" Name="AuthenticationInformation" Length="AuthenticationInformationLength" />
            <Param Type="ULONG" Name="AuthenticationInformationLength" />
            <Param Type="PTOKEN_GROUPS" Name="LocalGroups" />
            <Param Type="PTOKEN_SOURCE" Name="SourceContext" />
            <Param Type="PVOID*" Name="ProfileBuffer" PostLength="ProfileBufferLength" />
            <Param Type="PULONG" Name="ProfileBufferLength" />
            <Param Type="PLUID" Name="LogonId" />
            <Param Type="PHANDLE" Name="Token" />
            <Param Type="PQUOTA_LIMITS" Name="Quotas" />
            <Param Type="PNTSTATUS" Name="SubStatus" />
            <Return Type="NTSTATUS" />
        </Api>
        <Api Name="LsaLookupAuthenticationPackage">
            <Param Type="HANDLE" Name="LsaHandle" />
            <Param Type="PLSA_STRING" Name="PackageName" />
            <Param Type="PULONG" Name="AuthenticationPackage" />
            <Return Type="NTSTATUS" />
        </Api>
        <Api Name="LsaRegisterLogonProcess">
            <Param Type="PLSA_STRING" Name="LogonProcessName" />
            <Param Type="PHANDLE" Name="LsaHandle" />
            <Param Type="PLSA_OPERATIONAL_MODE" Name="SecurityMode" />
            <Return Type="NTSTATUS" />
        </Api>
        
        <!-- Simple Authentication and Security Layer (SASL) -->
        <Category Name="Security and Identity/Authentication/Simple Authentication and Security Layer (SASL)" />
        <Api Name="SaslAcceptSecurityContext">
            <Param Type="PCredHandle" Name="phCredential" />
            <Param Type="PCtxtHandle" Name="phContext" />
            <Param Type="PSecBufferDesc" Name="pInput" />
            <Param Type="[AcceptSecurityContextRequestFlags]" Name="fContextReq" />
            <Param Type="unsigned long" Name="TargetDataRep" />
            <Param Type="PCtxtHandle" Name="phNewContext" />
            <Param Type="PSecBufferDesc" Name="pOutput" />
            <Param Type="[AcceptSecurityContextRetFlags*]" Name="pfContextAttr" />
            <Param Type="PTimeStamp" Name="ptsExpiry" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="SaslEnumerateProfiles" BothCharset="True">
            <Param Type="LPTSTR*" Name="ProfileList" />
            <Param Type="ULONG*" Name="ProfileCount" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="SaslGetContextOption">
            <Param Type="PCtxtHandle" Name="ContextHandle" />
            <Param Type="ULONG" Name="Option" />
            <Param Type="PVOID" Name="Value" />
            <Param Type="ULONG" Name="Size" />
            <Param Type="PULONG" Name="Needed" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="SaslGetProfilePackage" BothCharset="True">
            <Param Type="LPTSTR" Name="ProfileName" />
            <Param Type="PSecPkgInfo*" Name="PackageInfo" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="SaslIdentifyPackage" BothCharset="True">
            <Param Type="PSecBufferDesc" Name="pInput" />
            <Param Type="PSecPkgInfo*" Name="PackageInfo" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="SaslInitializeSecurityContext" BothCharset="True">
            <Param Type="PCredHandle" Name="phCredential" />
            <Param Type="PCtxtHandle" Name="phContext" />
            <Param Type="LPTSTR" Name="pszTargetName" />
            <Param Type="[InitializeSecurityContextRequestFlags]" Name="fContextReq" />
            <Param Type="unsigned long" Name="Reserved1" />
            <Param Type="unsigned long" Name="TargetDataRep" />
            <Param Type="PSecBufferDesc" Name="pInput" />
            <Param Type="unsigned long" Name="Reserved2" />
            <Param Type="PCtxtHandle" Name="phNewContext" />
            <Param Type="PSecBufferDesc" Name="pOutput" />
            <Param Type="[InitializeSecurityContextRetFlags-unsigned-long*]" Name="pfContextAttr" />
            <Param Type="PTimeStamp" Name="ptsExpiry" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="SaslSetContextOption">
            <Param Type="PCtxtHandle" Name="ContextHandle" />
            <Param Type="ULONG" Name="Option" />
            <Param Type="PVOID" Name="Value" />
            <Param Type="ULONG" Name="Size" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        
        <!-- Authentication -->
        <Category Name="Security and Identity/Authentication" />
        <Api Name="AddSecurityPackage" BothCharset="True">
            <Param Type="LPTSTR" Name="pszPackageName" />
            <Param Type="PSECURITY_PACKAGE_OPTIONS" Name="pOptions" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="ChangeAccountPassword" BothCharset="True">
            <Param Type="SEC_WCHAR*" Name="pszPackageName" />
            <Param Type="SEC_WCHAR*" Name="pszDomainName" />
            <Param Type="SEC_WCHAR*" Name="pszAccountName" />
            <Param Type="SEC_WCHAR*" Name="pszOldPassword" />
            <Param Type="SEC_WCHAR*" Name="pszNewPassword" />
            <Param Type="BOOLEAN" Name="bImpersonating" />
            <Param Type="unsigned long" Name="dwReserved" />
            <Param Type="PSecBufferDesc" Name="pOutput" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        <Api Name="DeleteSecurityPackage" BothCharset="True">
            <Param Type="LPTSTR" Name="pszPackageName" />
            <Return Type="SECURITY_STATUS" />
        </Api>
        
        <!-- Security Management -->
        <Category Name="Security and Identity/Security Management" />
        <Api Name="LsaRegisterPolicyChangeNotification">
            <Param Type="POLICY_NOTIFICATION_INFORMATION_CLASS" Name="InformationClass" />
            <Param Type="HANDLE" Name="NotificationEventHandle" />
            <Return Type="NTSTATUS" />
        </Api>
        <Api Name="LsaUnregisterPolicyChangeNotification">
            <Param Type="POLICY_NOTIFICATION_INFORMATION_CLASS" Name="InformationClass" />
            <Param Type="HANDLE" Name="NotificationEventHandle" />
            <Return Type="NTSTATUS" />
        </Api>
    </Module>
</ApiMonitor>